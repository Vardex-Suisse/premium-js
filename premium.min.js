document.querySelectorAll("select").forEach(e => { "" == e[0].value && (e[0].disabled = !0) }); var nat2 = document.getElementById("nat2"), nat3 = document.getElementById("nat3"); function addCountries(e) { for (var t = "Switzerland,Liechtenstein,France,Italy,Germany,Austria,Afghanistan,Åland Islands,Albania,Algeria,American Samoa,Andorra,Angola,Anguilla,Antarctica,Antigua and Barbuda,Argentina,Armenia,Aruba,Australia,Azerbaijan,Bahamas,Bahrain,Bangladesh,Barbados,Belarus,Belgium,Belize,Benin,Bermuda,Bhutan,Bolivia,Bosnia and Herzegovina,Botswana,Bouvet Island,Brazil,British Indian Ocean Territory,Brunei Darussalam,Bulgaria,Burkina Faso,Burundi,Cambodia,Cameroon,Canada,Cape Verde,Cayman Islands,Central African Republic,Chad,Chile,China,Christmas Island,Cocos (Keeling) Islands,Colombia,Comoros,Congo,Congo,Cook Islands,Costa Rica,Côte d'Ivoire,Croatia,Cuba,Cyprus,Czech Republic,Denmark,Djibouti,Dominica,Dominican Republic,Ecuador,Egypt,El Salvador,Equatorial Guinea,Eritrea,Estonia,Ethiopia,Falkland Islands (Malvinas),Faroe Islands,Fiji,Finland,French Guiana,French Polynesia,French Southern Territories,Gabon,Gambia,Georgia,Ghana,Gibraltar,Greece,Greenland,Grenada,Guadeloupe,Guam,Guatemala,Guernsey,Guinea,Guinea-Bissau,Bolivarian Republic of,Haiti,Heard Island and McDonald Islands,Holy See (Vatican City State),Honduras,Hong Kong,Hungary,Iceland,India,Indonesia,Iran,Iraq,Ireland,Isle of Man,Israel,Jamaica,Japan,Jersey,Jordan,Kazakhstan,Kenya,South Korea,Kuwait,Kyrgyzstan,Lao People's Democratic Republic,Latvia,Lebanon,Lesotho,Liberia,Libyan Arab Jamahiriya,Lithuania,Luxembourg,Macao,Macedonia,Madagascar,Malawi,Malaysia,Maldives,Mali,Malta,Marshall Islands,Martinique,Mauritania,Mauritius,Mayotte,Mexico,Micronesia,Moldova,Monaco,Mongolia,Montenegro,Montserrat,Morocco,Mozambique,Myanmar,Namibia,Nauru,Nepal,Netherlands,Netherlands Antilles,New Caledonia,New Zealand,Nicaragua,Niger,Nigeria,Niue,Norfolk Island,Northern Mariana Islands,Norway,Oman,Pakistan,Palau,Palestinian Territory,Panama,Papua New Guinea,Paraguay,Peru,Philippines,Pitcairn,Poland,Portugal,Puerto Rico,Qatar,Réunion,Romania,Russian Federation,Rwanda,Saint Barthélemy,Saint Helena,Saint Kitts and Nevis,Saint Lucia,Saint Martin (French part),Saint Pierre and Miquelon,Saint Vincent and the Grenadines,Samoa,San Marino,Sao Tome and Principe,Saudi Arabia,Senegal,Serbia,Seychelles,Sierra Leone,Singapore,Slovakia,Slovenia,Solomon Islands,Somalia,South Africa,South Georgia and the South Sandwich Islands,Spain,Sri Lanka,Sudan,Suriname,Svalbard and Jan Mayen,Swaziland,Sweden,Syrian Arab Republic,Taiwan,Tajikistan,Tanzania,Thailand,Timor-Leste,Togo,Tokelau,Tonga,Trinidad and Tobago,Tunisia,Turkey,Turkmenistan,Turks and Caicos Islands,Tuvalu,Uganda,Ukraine,United Arab Emirates,United Kingdom,United States,United States Minor Outlying Islands,Uruguay,Uzbekistan,Vanuatu,Venezuela,Viet Nam,Virgin Islands British,Virgin Islands U.S.,Wallis and Futuna,Western Sahara,Yemen,Zambia,Zimbabwe".split(","), n = document.getElementById(e), a = 0; a < t.length; a++) { var i = document.createElement("option"); i.value = t[a], i.innerHTML = t[a], n.appendChild(i) } } document.getElementById("nat").onchange = function () { this.value == nat2.value && (nat2.className = nat2.className + " error") }, Webflow.push(function () { addCountries("country"), addCountries("nat"), addCountries("nat2"), addCountries("nat3"), addCountries("emp_country"), addCountries("semp_country") }); let formStep = 0; class MSF { constructor(e) { this.currentStep = e.startStep, this.form = document.getElementById(e.formID), this.next = document.getElementById(e.nextButtonID), this.back = document.getElementById(e.backButtonID), this.submitButton = this.form.querySelector('input[type="submit"]'), this.mask = this.form.querySelector(".w-slider-mask"), this.steps = this.form.querySelectorAll(".w-slide"), this.rightArrow = this.form.querySelector(".w-slider-arrow-right"), this.leftArrow = this.form.querySelector(".w-slider-arrow-left"), this.nextText = e.nextButtonText, this.submitText = e.submitButtonText, this.warningClass = e.warningClass, this.alertText = e.alertText, e.alertElementID && (this.alertElement = document.getElementById(e.alertElementID)), e.hiddenFormID && (this.hiddenForm = document.getElementById(e.hiddenFormID), this.hiddenSubmitButton = this.hiddenForm.querySelector('input[type="submit"]')) } getInputs(e) { const t = this.steps[e].querySelectorAll("input, select, textarea"); return Array.from(t) } setMaskHeight() { this.mask.style.height = "", this.mask.style.height = `${this.steps[this.currentStep].offsetHeight}px` } setNextButtonText() { this.currentStep === this.steps.length - 1 && (this.next.textContent = this.submitText), this.currentStep === this.steps.length - 2 && (this.next.textContent = this.nextText) } getCurrentStep() { return this.currentStep } goNext() { this.rightArrow.click() } goBack() { this.leftArrow.click() } submitForm() { this.submitButton.click() } submitHiddenForm(e) { this.getInputs(e).forEach(e => { const t = document.getElementById(`hidden-${e.id}`); t && (t.value = e.value) }), this.hiddenSubmitButton.click() } hideButtons() { this.next.style.display = "none", this.back.style.display = "none" } addWarningClass(e) { this.warningClass && e.classList.add(this.warningClass) } removeWarningClass(e) { this.warningClass && e.classList.remove(this.warningClass) } showAlert() { this.alertText && alert(this.alertText), this.alertElement && this.alertElement.classList.remove("hidden") } hideAlert() { this.alertElement && this.alertElement.classList.add("hidden") } setConfirmValues(e) { this.getInputs(e).forEach(e => { let t, n; if ("radio" === e.type) { const a = e.getAttribute("name"), i = document.querySelector(`input[name="${a}"]:checked`); i && (t = i.value, n = document.getElementById(`${a}-value`)) } else t = e.value, n = document.getElementById(`${e.id}-value`); t && n ? n.textContent = t : !t && n && (n.textContent = "-") }) } } const msfController = { init: e => { const t = t => { const a = e.getInputs(t).filter(e => e.required), i = a.filter(e => "checkbox" === e.type), r = a.filter(e => "radio" === e.type); let o = 0; return a.forEach(t => { t.value && "email" !== t.type ? (e.removeWarningClass(t), o++) : t.value && "email" === t.type && n(t.value) ? (e.removeWarningClass(t), o++) : e.addWarningClass(t) }), i.forEach(t => { const n = t.parentNode.querySelector(".w-checkbox-input"); t.checked ? (n && e.removeWarningClass(n), o++) : n && e.addWarningClass(n) }), r.forEach(t => { const n = t.parentNode.querySelector(".w-radio-input"), a = t.getAttribute("name"); document.querySelector(`input[name="${a}"]:checked`) ? (e.removeWarningClass(n), o++) : e.addWarningClass(n) }), o === a.length + i.length + r.length }, n = e => /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase()); e.next.addEventListener("click", () => { t(e.currentStep) ? (e.setConfirmValues(e.currentStep), e.currentStep++, e.currentStep === e.steps.length ? (e.submitForm(), e.hideButtons(), e.hideAlert()) : (e.goNext(), e.setMaskHeight(), e.setNextButtonText(), e.hideAlert())) : e.showAlert(), formStep = e.currentStep }), e.back.addEventListener("click", () => { const t = e.currentStep - 1; t >= 0 && (e.goBack(), e.currentStep = t, e.setMaskHeight(), e.setNextButtonText(), e.hideAlert()), formStep = e.currentStep }), e.hiddenForm && e.rightArrow.addEventListener("click", () => { e.submitHiddenForm(0) }, { once: !0 }), e.setMaskHeight(0) } }; Webflow.push(function () { document.getElementById("datepicker").flatpickr({ dateFormat: "m-d-Y", defaultDate: "01-01-1980", minDate: `01-01-${(new Date).getFullYear() - 90}`, maxDate: `01-01-${(new Date).getFullYear() - 16}` }), document.getElementById("ret_beg").flatpickr({ dateFormat: "m-d-Y", minDate: `01-01-${(new Date).getFullYear() - 60}` }); let e = new MSF({ startStep: formStep, formID: "msf", nextButtonID: "msf-next", backButtonID: "msf-back", nextButtonText: "Continue", submitButtonText: "Continue", warningClass: "warning" }); msfController.init(e) }); var n2 = document.getElementById("nat2"), n3 = document.getElementById("nat3"); function show() { "none" == n2.style.display ? (n2.required = !0, n2.style.display = "block", n2.required = !0, fields1.push("nat2")) : (n3.required = !0, n3.style.display = "block", n3.required = !0, fields1.push("nat3")) } function remove() { n3.required = !1, "block" == n3.style.display ? (n3.style.display = "none", n3.required = !1, fields1.pop("nat3")) : (n2.required = !1, n2.style.display = "none", n2.required = !1, fields1.pop("nat2")) } n2.style.display = "none", n3.style.display = "none", document.getElementById("add_n").onclick = function () { show() }, document.getElementById("remove_n").onclick = function () { remove() }; var fields2 = ["total_wealth", "ex_vol"], hiddenDivs = ["employed", "s_employed", "unemployed", "retired", "other_emp", "savings", "real_est", "inherited", "assets", "ico", "other"]; hiddenDivs.forEach(function (e) { document.getElementById(e).style.display = "none" }); var checkboxes = document.querySelectorAll("input[type=checkbox]"); checkboxes.forEach(function (e) { e.addEventListener("change", function () { var t = document.getElementById(e.dataset.id); e.checked ? (e.required = !0, t.style.display = "block", console.log(e.dataset.id), document.querySelectorAll("#" + e.dataset.id + " :input").each(function (e, t) { console.log(t.id), t.required = !0, fields2.push(t.id) })) : (e.required = !1, t.style.display = "none", document.querySelectorAll("#" + e.dataset.id + " :input").each(function (e, t) { console.log(t.id), t.required = !1, t.value = "", fields2 = arrayRemove(fields2, t.id) })) }) }); const res = document.getElementById("box_res"), res2 = document.getElementById("box2_res"), preventForm1 = document.getElementById("preventForm1"); function evalBox() { console.log(fields2); var e = document.querySelectorAll("input[type=checkbox]"); let t = !1, n = !1; return e.forEach(function (e) { "box" == e.getAttribute("data-name") ? e.checked && (t = !0) : "checkbox" == e.getAttribute("data-name") && e.checked && (n = !0) }), t ? (preventForm1.required = !1, res.style.display = "none") : (res.style.display = "block", res.innerHTML = "Please select at least one"), n ? (preventForm1.required = !1, res2.style.display = "none") : (res2.style.display = "block", res2.innerHTML = "Please select at least one"), !(!t || !n) } preventForm1.setAttribute("type", "hidden"); let token = ""; async function api_call(e, t, n) { console.log("Data to be sent", e); const a = "https://premium.vaerdex.ch:443" + t; let i = ""; if ("form" == n) { var r = {}; new FormData(e).forEach((e, t) => r[t] = e), console.log(JSON.stringify(r)), i = await fetch(a, { method: "POST", body: new FormData(e) }) } else i = await fetch(a, { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify(e) }); let o = await i.json(); if (console.log("Response headers: ", i.status), 200 != i.status) return console.log("Error occured sending data", i.status), !1; if (console.log("Server response: ", o), "email" == n) console.log("email token recieved"), token = o.token, customerId.setAttribute("value", o.token); else if ("getId" == n) { console.log("identID recieved"); var s = o.identId; console.log("IdentID: ", s), redirect_url = "https://go.test.idnow.de/" + s, document.getElementById("msf-next").style.backgroundColor = "", document.getElementById("msf-next").style.pointerEvents = "auto" } } const queryString = window.location.search, urlParams = new URLSearchParams(queryString), step = urlParams.get("step"), token_link = urlParams.get("token"), source = urlParams.get("source"), host_id = urlParams.get("id"); var fields1 = ["gender", "fname", "lname", "email", "phone", "datepicker", "lang", "nat", "street", "city", "zip_c", "country", "beneficial_owner"]; fields2 = fields2; const email = document.getElementById("email"), premium_form = document.getElementById("wf-form-premium-registration"), button = document.getElementById("msf-next"), back = document.getElementById("msf-back"), phone_res = document.getElementById("phone_res"), customerId = document.getElementById("token"), time0 = document.getElementById("time0"), time1 = document.getElementById("time1"), time2 = document.getElementById("time2"), preventForm = document.getElementById("preventForm"); let redirect_url = "", [skipStep0, skipStep1, skipStep2] = [!1, !1, !1]; function skipSteps() { 0 == formStep && skipStep0 ? (fields1.forEach(function (e) { document.getElementById(e).required = !1 }), button.click()) : 1 == formStep && skipStep1 ? (fields2.forEach(function (e) { document.getElementById(e).required = !1 }), button.click()) : 2 == formStep && skipStep2 && button.click() } function send(e) { if (validateForm(e)) { if (1 == e.length) return console.log("Email send init"), !!api_call({ email: email.value, fingerprint: fingerprint, source: source, host_id: host_id }, "/api/basic-data", "email"); if (e.length == fields1.length) return console.log("Form 1 Send init"), !!api_call(premium_form, "/api/form1", "form"); if (e.length == fields2.length) return console.log("Form 2 send init"), console.log(token), !!api_call(premium_form, "/api/form2", "form") } } function validateForm(e) { var t = !0; for (i = 0; i < e.length; i++) { var n = document.getElementById(`${e[i]}`); "email" == e[i] ? validateEmail(n) || (t = !1) : "phone" == e[i] ? validatePhone(n) || (t = !1) : "ass_desc" == e[i] || "real_desc" == e[i] || "inh_desc" == e[i] || "ico_desc" == e[i] || "oth_desc" == e[i] ? validateLength(n, e[i].slice(0, -5)) || (t = !1) : "beneficial_owner" == e[i] ? n.checked || (t = !1, n.className = n.className + " error") : validateText(n) || (t = !1) } return t } function validateText(e) { return "" == e.value ? (e.className = e.className + " error", !1) : (e.className = e.className.replace(" error", ""), !0) } function validateEmail() { return /\S+@\S+\.\S+/.test(email.value) ? (email_res.style.display = "none", !0) : (email_res.style.display = "block", email_res.innerHTML = "Email has to be in format name@domain.ch", !1) } function validateLength(e, t) { var n = t + "_res", a = document.getElementById(`${n}`); return e.value.length < 10 ? (a.style.display = "block", a.innerHTML = "Please describe your wealth in more detail.", !1) : (a.style.display = "none", !0) } function validatePhone(e) { const t = document.getElementById(e.id + "_res"); return /^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/im.test(e.value.replace(/ /g, "")) ? (t.style.display = "none", !0) : (t.style.display = "block", t.innerHTML = "Your phone number is required.", !1) } function arrayRemove(e, t) { return e.filter(function (e) { return e != t }) } null != step && step.includes("0") && (email.disabled = !0, email.required = !1, fields1 = arrayRemove(fields1, "email"), console.log(fields1)), "0" == step ? (skipStep1 = !0, skipStep2 = !0, time1.innerHTML = "Completed", time2.innerHTML = "Completed", redirect_url = "https://dev-vaerdex.webflow.io/update-success") : "1" == step ? (skipStep0 = !0, skipStep2 = !0, time0.innerHTML = "Completed", time2.innerHTML = "Completed", redirect_url = "https://dev-vaerdex.webflow.io/update-success") : "2" == step ? (skipStep0 = !0, skipStep1 = !0, time0.innerHTML = "Completed", time1.innerHTML = "Completed") : "0,1" == step ? (skipStep2 = !0, time2.innerHTML = "Completed", redirect_url = "https://dev-vaerdex.webflow.io/update-success") : "1,2" == step ? (skipStep0 = !0, time0.innerHTML = "Completed") : "0,2" == step && (skipStep1 = !0, time1.innerHTML = "Completed"), customerId.setAttribute("type", "hidden"), preventForm.setAttribute("type", "hidden"), email.onfocusout = function () { send(["email"]) }, setInterval("skipSteps()", 50), button.onclick = function () { "" == token && (token = token_link.split(" ").join("+"), customerId.setAttribute("value", token), console.log("No token found in variable")), console.log(token), 0 == formStep ? (console.log("Step 0"), send(fields1) ? (preventForm.required = !1, console.log("to step 1"), time0.innerHTML = "Completed") : skipStep0 || (preventForm.required = !0)) : 1 == formStep ? (console.log("Step 1"), skipStep1 ? skipStep2 || (button.style.backgroundColor = "#e5e5e5", button.style.pointerEvents = "none", time1.innerHTML = "Completed", console.log("to step 2"), api_call({ token: token }, "/api/id", "getId")) : evalBox() && send(fields2) ? (button.style.backgroundColor = "#e5e5e5", button.style.pointerEvents = "none", time1.innerHTML = "Completed", console.log("to step 2"), api_call({ token: token }, "/api/id", "getId")) : preventForm1.required = !0) : 2 == formStep && (time2.innerHTML = "Completed", console.log(redirect_url), window.location.href = redirect_url) }, document.querySelectorAll('[data-type="number"]').forEach(function (e) { e.addEventListener("change", function () { var t = document.getElementById(e.getAttribute("data-res")); console.log("Element value: ", e.value), e.value < 1e4 ? (t.style.display = "block", t.innerHTML = "Please provide your yearly salary.", e.className = e.className + " error", e.value = "", e.required = !0) : (t.style.display = "none", e.className = e.className.replace(" error", "")) }) });